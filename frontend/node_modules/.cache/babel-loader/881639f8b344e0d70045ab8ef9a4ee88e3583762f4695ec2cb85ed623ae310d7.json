{"ast":null,"code":"var _jsxFileName = \"C:\\\\Web Systems\\\\GovConnect\\\\frontend\\\\src\\\\components\\\\MapPicker.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MapPicker({\n  lat,\n  lng,\n  onChange,\n  className\n}) {\n  _s();\n  const [loaded, setLoaded] = useState(!!window.L);\n  const containerId = useMemo(() => 'map_' + Math.random().toString(36).slice(2), []);\n  const mapRef = useRef(null);\n  const markerRef = useRef(null);\n  useEffect(() => {\n    // Inject Leaflet CSS/JS if not loaded\n    if (!window.L) {\n      const cssId = 'leaflet-css';\n      if (!document.getElementById(cssId)) {\n        const link = document.createElement('link');\n        link.id = cssId;\n        link.rel = 'stylesheet';\n        link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\n        document.head.appendChild(link);\n      }\n      const jsId = 'leaflet-js';\n      if (!document.getElementById(jsId)) {\n        const script = document.createElement('script');\n        script.id = jsId;\n        script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\n        script.async = true;\n        script.onload = () => setLoaded(true);\n        document.body.appendChild(script);\n      } else {\n        // If script tag exists but L not yet ready, wait a tick\n        const interval = setInterval(() => {\n          if (window.L) {\n            setLoaded(true);\n            clearInterval(interval);\n          }\n        }, 50);\n        return () => clearInterval(interval);\n      }\n    } else {\n      setLoaded(true);\n    }\n  }, []);\n  useEffect(() => {\n    if (!loaded || mapRef.current) return;\n    const L = window.L;\n    const initial = [lat !== null && lat !== void 0 ? lat : 14.5995, lng !== null && lng !== void 0 ? lng : 120.9842]; // Default: Manila\n    const map = L.map(containerId).setView(initial, lat && lng ? 16 : 13);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      maxZoom: 19,\n      attribution: '&copy; OpenStreetMap contributors'\n    }).addTo(map);\n    map.on('click', e => {\n      const {\n        lat: la,\n        lng: ln\n      } = e.latlng;\n      setMarker(L, map, la, ln);\n      onChange === null || onChange === void 0 ? void 0 : onChange({\n        lat: la,\n        lng: ln\n      });\n    });\n    mapRef.current = map;\n    if (lat && lng) setMarker(L, map, lat, lng);\n    return () => {\n      map.remove();\n      mapRef.current = null;\n      markerRef.current = null;\n    };\n  }, [loaded, containerId]);\n  useEffect(() => {\n    if (!loaded || !mapRef.current) return;\n    const L = window.L;\n    if (lat != null && lng != null) {\n      setMarker(L, mapRef.current, lat, lng, false);\n      mapRef.current.setView([lat, lng], 16);\n    }\n  }, [lat, lng, loaded]);\n  function setMarker(L, map, la, ln, pan = false) {\n    if (markerRef.current) {\n      markerRef.current.setLatLng([la, ln]);\n    } else {\n      markerRef.current = L.marker([la, ln], {\n        draggable: true\n      }).addTo(map);\n      markerRef.current.on('dragend', () => {\n        const p = markerRef.current.getLatLng();\n        onChange === null || onChange === void 0 ? void 0 : onChange({\n          lat: p.lat,\n          lng: p.lng\n        });\n      });\n    }\n    if (pan) map.panTo([la, ln]);\n  }\n  async function useMyLocation() {\n    if (!navigator.geolocation) return;\n    navigator.geolocation.getCurrentPosition(pos => {\n      const la = pos.coords.latitude;\n      const ln = pos.coords.longitude;\n      if (window.L && mapRef.current) {\n        setMarker(window.L, mapRef.current, la, ln, true);\n      }\n      onChange === null || onChange === void 0 ? void 0 : onChange({\n        lat: la,\n        lng: ln\n      });\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: className,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: containerId,\n      className: \"w-full h-64 rounded-md border overflow-hidden\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between mt-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-gray-600\",\n        children: lat != null && lng != null ? `Pinned: ${lat.toFixed(5)}, ${lng.toFixed(5)}` : 'Click on map to pin location'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"text-xs px-2 py-1 border rounded-md bg-white hover:bg-gray-50\",\n        onClick: useMyLocation,\n        children: \"Use my location\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n}\n_s(MapPicker, \"k5lVom1yHVmwvTJDhBHP+iIr1J0=\");\n_c = MapPicker;\nvar _c;\n$RefreshReg$(_c, \"MapPicker\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","jsxDEV","_jsxDEV","MapPicker","lat","lng","onChange","className","_s","loaded","setLoaded","window","L","containerId","Math","random","toString","slice","mapRef","markerRef","cssId","document","getElementById","link","createElement","id","rel","href","head","appendChild","jsId","script","src","async","onload","body","interval","setInterval","clearInterval","current","initial","map","setView","tileLayer","maxZoom","attribution","addTo","on","e","la","ln","latlng","setMarker","remove","pan","setLatLng","marker","draggable","p","getLatLng","panTo","useMyLocation","navigator","geolocation","getCurrentPosition","pos","coords","latitude","longitude","children","fileName","_jsxFileName","lineNumber","columnNumber","toFixed","type","onClick","_c","$RefreshReg$"],"sources":["C:/Web Systems/GovConnect/frontend/src/components/MapPicker.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\r\n\r\nexport default function MapPicker({ lat, lng, onChange, className }) {\r\n  const [loaded, setLoaded] = useState(!!window.L);\r\n  const containerId = useMemo(() => 'map_' + Math.random().toString(36).slice(2), []);\r\n  const mapRef = useRef(null);\r\n  const markerRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    // Inject Leaflet CSS/JS if not loaded\r\n    if (!window.L) {\r\n      const cssId = 'leaflet-css';\r\n      if (!document.getElementById(cssId)) {\r\n        const link = document.createElement('link');\r\n        link.id = cssId;\r\n        link.rel = 'stylesheet';\r\n        link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\r\n        document.head.appendChild(link);\r\n      }\r\n      const jsId = 'leaflet-js';\r\n      if (!document.getElementById(jsId)) {\r\n        const script = document.createElement('script');\r\n        script.id = jsId;\r\n        script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\r\n        script.async = true;\r\n        script.onload = () => setLoaded(true);\r\n        document.body.appendChild(script);\r\n      } else {\r\n        // If script tag exists but L not yet ready, wait a tick\r\n        const interval = setInterval(() => {\r\n          if (window.L) { setLoaded(true); clearInterval(interval); }\r\n        }, 50);\r\n        return () => clearInterval(interval);\r\n      }\r\n    } else {\r\n      setLoaded(true);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!loaded || mapRef.current) return;\r\n    const L = window.L;\r\n    const initial = [lat ?? 14.5995, lng ?? 120.9842]; // Default: Manila\r\n    const map = L.map(containerId).setView(initial, lat && lng ? 16 : 13);\r\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      maxZoom: 19,\r\n      attribution: '&copy; OpenStreetMap contributors',\r\n    }).addTo(map);\r\n    map.on('click', (e) => {\r\n      const { lat: la, lng: ln } = e.latlng;\r\n      setMarker(L, map, la, ln);\r\n      onChange?.({ lat: la, lng: ln });\r\n    });\r\n    mapRef.current = map;\r\n\r\n    if (lat && lng) setMarker(L, map, lat, lng);\r\n\r\n    return () => { map.remove(); mapRef.current = null; markerRef.current = null; };\r\n  }, [loaded, containerId]);\r\n\r\n  useEffect(() => {\r\n    if (!loaded || !mapRef.current) return;\r\n    const L = window.L;\r\n    if (lat != null && lng != null) {\r\n      setMarker(L, mapRef.current, lat, lng, false);\r\n      mapRef.current.setView([lat, lng], 16);\r\n    }\r\n  }, [lat, lng, loaded]);\r\n\r\n  function setMarker(L, map, la, ln, pan = false) {\r\n    if (markerRef.current) {\r\n      markerRef.current.setLatLng([la, ln]);\r\n    } else {\r\n      markerRef.current = L.marker([la, ln], { draggable: true }).addTo(map);\r\n      markerRef.current.on('dragend', () => {\r\n        const p = markerRef.current.getLatLng();\r\n        onChange?.({ lat: p.lat, lng: p.lng });\r\n      });\r\n    }\r\n    if (pan) map.panTo([la, ln]);\r\n  }\r\n\r\n  async function useMyLocation() {\r\n    if (!navigator.geolocation) return;\r\n    navigator.geolocation.getCurrentPosition((pos) => {\r\n      const la = pos.coords.latitude;\r\n      const ln = pos.coords.longitude;\r\n      if (window.L && mapRef.current) {\r\n        setMarker(window.L, mapRef.current, la, ln, true);\r\n      }\r\n      onChange?.({ lat: la, lng: ln });\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className={className}>\r\n      <div id={containerId} className=\"w-full h-64 rounded-md border overflow-hidden\" />\r\n      <div className=\"flex items-center justify-between mt-2\">\r\n        <div className=\"text-xs text-gray-600\">{lat != null && lng != null ? `Pinned: ${lat.toFixed(5)}, ${lng.toFixed(5)}` : 'Click on map to pin location'}</div>\r\n        <button type=\"button\" className=\"text-xs px-2 py-1 border rounded-md bg-white hover:bg-gray-50\" onClick={useMyLocation}>Use my location</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}