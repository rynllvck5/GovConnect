{"ast":null,"code":"var _jsxFileName = \"C:\\\\Web Systems\\\\GovConnect\\\\frontend\\\\src\\\\pages\\\\Tourism.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { API_BASE, API_ORIGIN } from '../config';\nimport Modal from '../components/Modal';\nimport CategoryForm from '../components/tourism/CategoryForm';\nimport EntryForm from '../components/tourism/EntryForm';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Tourism() {\n  _s();\n  const {\n    user,\n    token\n  } = useAuth();\n  const isAdmin = !!user && (user.role === 'admin' || user.role === 'superadmin');\n  const myBarangayId = (user === null || user === void 0 ? void 0 : user.barangayId) || (user === null || user === void 0 ? void 0 : user.barangay_id) || null;\n  const [dynCats, setDynCats] = useState([]);\n  const [dynLoading, setDynLoading] = useState(false);\n  const [dynError, setDynError] = useState('');\n  const [entriesByCat, setEntriesByCat] = useState({});\n  const [catModal, setCatModal] = useState(null); // null | { mode:'add' } | { mode:'edit', cat }\n  const [catDelete, setCatDelete] = useState(null);\n  const [catDeleteStatus, setCatDeleteStatus] = useState({\n    kind: null,\n    text: ''\n  });\n  const [entryModal, setEntryModal] = useState(null); // null | { mode:'add', cat } | { mode:'edit', entry, cat }\n  const [entryDelete, setEntryDelete] = useState(null);\n  const [entryDeleteStatus, setEntryDeleteStatus] = useState({\n    kind: null,\n    text: ''\n  });\n  async function loadDynCats() {\n    setDynLoading(true);\n    setDynError('');\n    try {\n      const r = await fetch(`${API_BASE}/tourism/categories`);\n      if (!r.ok) throw new Error('Failed loading categories');\n      const list = await r.json();\n      setDynCats(Array.isArray(list) ? list : []);\n    } catch (e) {\n      setDynError(e.message || 'Error');\n    } finally {\n      setDynLoading(false);\n    }\n  }\n  async function loadEntries(catId) {\n    try {\n      const r = await fetch(`${API_BASE}/tourism/categories/${catId}/entries`);\n      if (!r.ok) throw new Error('Failed loading entries');\n      const list = await r.json();\n      setEntriesByCat(prev => ({\n        ...prev,\n        [catId]: Array.isArray(list) ? list : []\n      }));\n    } catch {}\n  }\n  useEffect(() => {\n    loadDynCats();\n  }, []);\n  useEffect(() => {\n    (dynCats || []).forEach(c => {\n      loadEntries(c.id);\n    });\n  }, [dynCats]);\n  useEffect(() => {\n    if (catDelete) setCatDeleteStatus({\n      kind: null,\n      text: ''\n    });\n  }, [catDelete]);\n  useEffect(() => {\n    if (entryDelete) setEntryDeleteStatus({\n      kind: null,\n      text: ''\n    });\n  }, [entryDelete]);\n  function EntryCard({\n    cat,\n    e\n  }) {\n    const canEditEntry = isAdmin || !!user && user.role === 'barangay_captain' && myBarangayId && Number(myBarangayId) === Number(e.barangay_id);\n    const content = e.content_json || {};\n    const title = e.title || content.name || '—';\n    const img = content.image || Array.isArray(content.images) && content.images[0] || Array.isArray(content.gallery) && content.gallery[0] || null;\n    const desc = content.description || '';\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border rounded-md overflow-hidden bg-white hover:border-blue-400\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: [img && /*#__PURE__*/_jsxDEV(\"img\", {\n          src: `${String(img).match(/^https?:|^data:/) ? String(img) : API_ORIGIN + String(img)}`,\n          alt: \"\",\n          className: \"w-full h-32 object-cover\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 19\n        }, this), (isAdmin || canEditEntry) && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-2 right-2 flex gap-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setEntryModal({\n              mode: 'edit',\n              entry: e,\n              cat\n            }),\n            className: \"text-xs px-2 py-1 rounded bg-yellow-500 text-white\",\n            children: \"Edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 15\n          }, this), isAdmin && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setEntryDelete(e),\n            className: \"text-xs px-2 py-1 rounded bg-red-600 text-white\",\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 27\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: `/tourism/${cat.slug}/${e.slug}`,\n        className: \"block p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-medium\",\n          children: title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), desc && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 line-clamp-2\",\n          children: desc\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 20\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this);\n  }\n  function DynamicCategorySection({\n    cat\n  }) {\n    const entries = entriesByCat[cat.id] || [];\n    if (!isAdmin && entries.length === 0) return null;\n    return /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"scroll-mt-20\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold mb-3\",\n          children: cat.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this), isAdmin && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setEntryModal({\n              mode: 'add',\n              cat\n            }),\n            className: \"text-sm px-3 py-1.5 rounded border bg-white\",\n            children: \"Add\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setCatModal({\n              mode: 'edit',\n              cat\n            }),\n            className: \"text-sm px-3 py-1.5 rounded border bg-white\",\n            children: \"Edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setCatDelete(cat),\n            className: \"text-sm px-3 py-1.5 rounded border bg-white text-red-700\",\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), cat.description && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-sm text-gray-700 mb-2\",\n        children: cat.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 29\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid md:grid-cols-2 lg:grid-cols-3 gap-4\",\n        children: entries.map(e => /*#__PURE__*/_jsxDEV(EntryCard, {\n          e: e,\n          cat: cat\n        }, e.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), isAdmin && entries.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-sm text-gray-600\",\n        children: \"No entries yet.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 45\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-semibold mb-1\",\n          children: \"Tourism\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: \"Discover spots, local products, and heritage sites in Caba.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this), isAdmin && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setCatModal({\n          mode: 'add'\n        }),\n        className: \"text-sm px-3 py-2 rounded border bg-white\",\n        children: \"Add Category\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this), dynLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-sm text-gray-600\",\n      children: \"Loading categories...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 22\n    }, this), dynError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-sm text-red-600\",\n      children: dynError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 20\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-8\",\n      children: [(isAdmin ? dynCats : (dynCats || []).filter(c => (entriesByCat[c.id] || []).length > 0)).map((c, idx) => /*#__PURE__*/_jsxDEV(React.Fragment, {\n        children: [idx > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"my-4 border-t border-gray-200\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(DynamicCategorySection, {\n          cat: c\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 13\n        }, this)]\n      }, c.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this)), isAdmin && (!dynCats || dynCats.length === 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-sm text-gray-600\",\n        children: \"No categories yet.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 59\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: !!catModal,\n      onClose: () => setCatModal(null),\n      title: (catModal === null || catModal === void 0 ? void 0 : catModal.mode) === 'edit' ? 'Edit Category' : 'Add Category',\n      children: catModal && /*#__PURE__*/_jsxDEV(CategoryForm, {\n        category: catModal.mode === 'edit' ? catModal.cat : undefined,\n        onClose: () => setCatModal(null),\n        onSaved: () => {\n          setCatModal(null);\n          loadDynCats();\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: !!entryModal,\n      onClose: () => setEntryModal(null),\n      title: (entryModal === null || entryModal === void 0 ? void 0 : entryModal.mode) === 'edit' ? 'Edit Entry' : 'Add Entry',\n      children: entryModal && /*#__PURE__*/_jsxDEV(EntryForm, {\n        category: entryModal.cat || dynCats.find(c => {\n          var _entryModal$entry;\n          return c.id === ((_entryModal$entry = entryModal.entry) === null || _entryModal$entry === void 0 ? void 0 : _entryModal$entry.category_id);\n        }),\n        entry: entryModal.mode === 'edit' ? entryModal.entry : undefined,\n        onClose: () => setEntryModal(null),\n        onSaved: () => {\n          var _entryModal$cat, _entryModal$entry2;\n          setEntryModal(null);\n          const cid = ((_entryModal$cat = entryModal.cat) === null || _entryModal$cat === void 0 ? void 0 : _entryModal$cat.id) || ((_entryModal$entry2 = entryModal.entry) === null || _entryModal$entry2 === void 0 ? void 0 : _entryModal$entry2.category_id);\n          if (cid) loadEntries(cid);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: !!catDelete,\n      onClose: () => setCatDelete(null),\n      title: \"Delete Category\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-700\",\n          children: [\"Delete \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: catDelete === null || catDelete === void 0 ? void 0 : catDelete.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 55\n          }, this), \"? This will remove all its entries.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }, this), catDeleteStatus.kind ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `px-4 py-2 rounded-md text-sm ${catDeleteStatus.kind === 'success' ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'}`,\n          children: catDeleteStatus.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => setCatDelete(null),\n            className: \"px-4 py-2 rounded-md border\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: async () => {\n              try {\n                if (!catDelete) return;\n                const r = await fetch(`${API_BASE}/tourism/categories/${catDelete.id}`, {\n                  method: 'DELETE',\n                  headers: {\n                    Authorization: `Bearer ${token}`\n                  }\n                });\n                if (!r.ok) {\n                  const e = await r.json().catch(() => ({}));\n                  throw new Error(e.error || 'Failed to delete');\n                }\n                setCatDeleteStatus({\n                  kind: 'success',\n                  text: 'Deleted successfully.'\n                });\n                setTimeout(async () => {\n                  setCatDeleteStatus({\n                    kind: null,\n                    text: ''\n                  });\n                  setCatDelete(null);\n                  await loadDynCats();\n                }, 1500);\n              } catch (err) {\n                setCatDeleteStatus({\n                  kind: 'error',\n                  text: err.message || 'An error occurred.'\n                });\n                setTimeout(() => setCatDeleteStatus({\n                  kind: null,\n                  text: ''\n                }), 2000);\n              }\n            },\n            className: \"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700\",\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: !!entryDelete,\n      onClose: () => setEntryDelete(null),\n      title: \"Delete Entry\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-700\",\n          children: [\"Delete \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium\",\n            children: (entryDelete === null || entryDelete === void 0 ? void 0 : entryDelete.title) || 'this entry'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 55\n          }, this), \"?\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this), entryDeleteStatus.kind ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `px-4 py-2 rounded-md text-sm ${entryDeleteStatus.kind === 'success' ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'}`,\n          children: entryDeleteStatus.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => setEntryDelete(null),\n            className: \"px-4 py-2 rounded-md border\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: async () => {\n              try {\n                if (!entryDelete) return;\n                const r = await fetch(`${API_BASE}/tourism/entries/${entryDelete.id}`, {\n                  method: 'DELETE',\n                  headers: {\n                    Authorization: `Bearer ${token}`\n                  }\n                });\n                if (!r.ok) {\n                  const e = await r.json().catch(() => ({}));\n                  throw new Error(e.error || 'Failed to delete');\n                }\n                const cid = entryDelete.category_id;\n                setEntryDeleteStatus({\n                  kind: 'success',\n                  text: 'Deleted successfully.'\n                });\n                setTimeout(async () => {\n                  setEntryDeleteStatus({\n                    kind: null,\n                    text: ''\n                  });\n                  setEntryDelete(null);\n                  if (cid) await loadEntries(cid);\n                }, 1500);\n              } catch (err) {\n                setEntryDeleteStatus({\n                  kind: 'error',\n                  text: err.message || 'An error occurred.'\n                });\n                setTimeout(() => setEntryDeleteStatus({\n                  kind: null,\n                  text: ''\n                }), 2000);\n              }\n            },\n            className: \"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700\",\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n}\n_s(Tourism, \"YQJNHLH9MGOwVPge+ldhNnbdYiw=\", false, function () {\n  return [useAuth];\n});\n_c = Tourism;\nvar _c;\n$RefreshReg$(_c, \"Tourism\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","Link","useAuth","API_BASE","API_ORIGIN","Modal","CategoryForm","EntryForm","jsxDEV","_jsxDEV","Tourism","_s","user","token","isAdmin","role","myBarangayId","barangayId","barangay_id","dynCats","setDynCats","dynLoading","setDynLoading","dynError","setDynError","entriesByCat","setEntriesByCat","catModal","setCatModal","catDelete","setCatDelete","catDeleteStatus","setCatDeleteStatus","kind","text","entryModal","setEntryModal","entryDelete","setEntryDelete","entryDeleteStatus","setEntryDeleteStatus","loadDynCats","r","fetch","ok","Error","list","json","Array","isArray","e","message","loadEntries","catId","prev","forEach","c","id","EntryCard","cat","canEditEntry","Number","content","content_json","title","name","img","image","images","gallery","desc","description","className","children","src","String","match","alt","fileName","_jsxFileName","lineNumber","columnNumber","onClick","mode","entry","to","slug","DynamicCategorySection","entries","length","map","filter","idx","Fragment","open","onClose","category","undefined","onSaved","find","_entryModal$entry","category_id","_entryModal$cat","_entryModal$entry2","cid","type","method","headers","Authorization","catch","error","setTimeout","err","_c","$RefreshReg$"],"sources":["C:/Web Systems/GovConnect/frontend/src/pages/Tourism.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { API_BASE, API_ORIGIN } from '../config';\nimport Modal from '../components/Modal';\nimport CategoryForm from '../components/tourism/CategoryForm';\nimport EntryForm from '../components/tourism/EntryForm';\n\nexport default function Tourism() {\n  const { user, token } = useAuth();\n  const isAdmin = !!user && (user.role === 'admin' || user.role === 'superadmin');\n  const myBarangayId = user?.barangayId || user?.barangay_id || null;\n\n  const [dynCats, setDynCats] = useState([]);\n  const [dynLoading, setDynLoading] = useState(false);\n  const [dynError, setDynError] = useState('');\n  const [entriesByCat, setEntriesByCat] = useState({});\n  const [catModal, setCatModal] = useState(null); // null | { mode:'add' } | { mode:'edit', cat }\n  const [catDelete, setCatDelete] = useState(null);\n  const [catDeleteStatus, setCatDeleteStatus] = useState({ kind: null, text: '' });\n  const [entryModal, setEntryModal] = useState(null); // null | { mode:'add', cat } | { mode:'edit', entry, cat }\n  const [entryDelete, setEntryDelete] = useState(null);\n  const [entryDeleteStatus, setEntryDeleteStatus] = useState({ kind: null, text: '' });\n\n  async function loadDynCats() {\n    setDynLoading(true); setDynError('');\n    try {\n      const r = await fetch(`${API_BASE}/tourism/categories`);\n      if (!r.ok) throw new Error('Failed loading categories');\n      const list = await r.json();\n      setDynCats(Array.isArray(list) ? list : []);\n    } catch (e) { setDynError(e.message || 'Error'); }\n    finally { setDynLoading(false); }\n  }\n  async function loadEntries(catId) {\n    try {\n      const r = await fetch(`${API_BASE}/tourism/categories/${catId}/entries`);\n      if (!r.ok) throw new Error('Failed loading entries');\n      const list = await r.json();\n      setEntriesByCat(prev => ({ ...prev, [catId]: Array.isArray(list) ? list : [] }));\n    } catch {}\n  }\n  useEffect(() => { loadDynCats(); }, []);\n  useEffect(() => { (dynCats || []).forEach(c => { loadEntries(c.id); }); }, [dynCats]);\n  useEffect(() => { if (catDelete) setCatDeleteStatus({ kind: null, text: '' }); }, [catDelete]);\n  useEffect(() => { if (entryDelete) setEntryDeleteStatus({ kind: null, text: '' }); }, [entryDelete]);\n\n  function EntryCard({ cat, e }) {\n    const canEditEntry = isAdmin || (!!user && user.role === 'barangay_captain' && myBarangayId && Number(myBarangayId) === Number(e.barangay_id));\n    const content = e.content_json || {};\n    const title = e.title || content.name || '—';\n    const img = content.image || (Array.isArray(content.images) && content.images[0]) || (Array.isArray(content.gallery) && content.gallery[0]) || null;\n    const desc = content.description || '';\n    return (\n      <div className=\"border rounded-md overflow-hidden bg-white hover:border-blue-400\">\n        <div className=\"relative\">\n          {img && <img src={`${String(img).match(/^https?:|^data:/) ? String(img) : API_ORIGIN + String(img)}`} alt=\"\" className=\"w-full h-32 object-cover\" />}\n          {(isAdmin || canEditEntry) && (\n            <div className=\"absolute top-2 right-2 flex gap-1\">\n              <button onClick={()=>setEntryModal({ mode:'edit', entry: e, cat })} className=\"text-xs px-2 py-1 rounded bg-yellow-500 text-white\">Edit</button>\n              {isAdmin && <button onClick={()=>setEntryDelete(e)} className=\"text-xs px-2 py-1 rounded bg-red-600 text-white\">Delete</button>}\n            </div>\n          )}\n        </div>\n        <Link to={`/tourism/${cat.slug}/${e.slug}`} className=\"block p-4\">\n          <div className=\"font-medium\">{title}</div>\n          {desc && <div className=\"text-sm text-gray-600 line-clamp-2\">{desc}</div>}\n        </Link>\n      </div>\n    );\n  }\n\n  function DynamicCategorySection({ cat }) {\n    const entries = entriesByCat[cat.id] || [];\n    if (!isAdmin && entries.length === 0) return null;\n    return (\n      <section className=\"scroll-mt-20\">\n        <div className=\"flex items-center justify-between\">\n          <h2 className=\"text-xl font-semibold mb-3\">{cat.title}</h2>\n          {isAdmin && (\n            <div className=\"flex items-center gap-2\">\n              <button onClick={()=>setEntryModal({ mode:'add', cat })} className=\"text-sm px-3 py-1.5 rounded border bg-white\">Add</button>\n              <button onClick={()=>setCatModal({ mode:'edit', cat })} className=\"text-sm px-3 py-1.5 rounded border bg-white\">Edit</button>\n              <button onClick={()=>setCatDelete(cat)} className=\"text-sm px-3 py-1.5 rounded border bg-white text-red-700\">Delete</button>\n            </div>\n          )}\n        </div>\n        {cat.description && <div className=\"text-sm text-gray-700 mb-2\">{cat.description}</div>}\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          {entries.map((e) => (\n            <EntryCard key={e.id} e={e} cat={cat} />\n          ))}\n        </div>\n        {isAdmin && entries.length === 0 && <div className=\"text-sm text-gray-600\">No entries yet.</div>}\n      </section>\n    );\n  }\n\n  return (\n    <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-semibold mb-1\">Tourism</h1>\n          <p className=\"text-gray-600\">Discover spots, local products, and heritage sites in Caba.</p>\n        </div>\n        {isAdmin && (\n          <button onClick={()=>setCatModal({ mode:'add' })} className=\"text-sm px-3 py-2 rounded border bg-white\">Add Category</button>\n        )}\n      </div>\n\n      {dynLoading && <div className=\"text-sm text-gray-600\">Loading categories...</div>}\n      {dynError && <div className=\"text-sm text-red-600\">{dynError}</div>}\n      <div className=\"space-y-8\">\n        {(isAdmin ? dynCats : (dynCats || []).filter(c => (entriesByCat[c.id] || []).length > 0)).map((c, idx) => (\n          <React.Fragment key={c.id}>\n            {idx > 0 && <div className=\"my-4 border-t border-gray-200\" />}\n            <DynamicCategorySection cat={c} />\n          </React.Fragment>\n        ))}\n        {isAdmin && (!dynCats || dynCats.length === 0) && <div className=\"text-sm text-gray-600\">No categories yet.</div>}\n      </div>\n\n      {/* Category Modal */}\n      <Modal open={!!catModal} onClose={()=>setCatModal(null)} title={catModal?.mode === 'edit' ? 'Edit Category' : 'Add Category'}>\n        {catModal && (\n          <CategoryForm\n            category={catModal.mode === 'edit' ? catModal.cat : undefined}\n            onClose={()=>setCatModal(null)}\n            onSaved={()=>{ setCatModal(null); loadDynCats(); }}\n          />\n        )}\n      </Modal>\n\n      {/* Entry Modal */}\n      <Modal open={!!entryModal} onClose={()=>setEntryModal(null)} title={entryModal?.mode === 'edit' ? 'Edit Entry' : 'Add Entry'}>\n        {entryModal && (\n          <EntryForm\n            category={entryModal.cat || dynCats.find(c=>c.id === (entryModal.entry?.category_id))}\n            entry={entryModal.mode === 'edit' ? entryModal.entry : undefined}\n            onClose={()=>setEntryModal(null)}\n            onSaved={()=>{ setEntryModal(null); const cid = (entryModal.cat?.id) || (entryModal.entry?.category_id); if (cid) loadEntries(cid); }}\n          />\n        )}\n      </Modal>\n\n      {/* Category Delete */}\n      <Modal open={!!catDelete} onClose={()=>setCatDelete(null)} title=\"Delete Category\">\n        <div className=\"space-y-4\">\n          <p className=\"text-sm text-gray-700\">Delete <span className=\"font-medium\">{catDelete?.title}</span>? This will remove all its entries.</p>\n          {catDeleteStatus.kind ? (\n            <div className={`px-4 py-2 rounded-md text-sm ${catDeleteStatus.kind==='success' ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'}`}>{catDeleteStatus.text}</div>\n          ) : (\n            <div className=\"flex justify-end gap-2\">\n              <button type=\"button\" onClick={()=>setCatDelete(null)} className=\"px-4 py-2 rounded-md border\">Cancel</button>\n              <button\n                type=\"button\"\n                onClick={async ()=>{\n                  try {\n                    if (!catDelete) return;\n                    const r = await fetch(`${API_BASE}/tourism/categories/${catDelete.id}`, { method: 'DELETE', headers: { Authorization: `Bearer ${token}` }});\n                    if (!r.ok) { const e = await r.json().catch(()=>({})); throw new Error(e.error || 'Failed to delete'); }\n                    setCatDeleteStatus({ kind: 'success', text: 'Deleted successfully.' });\n                    setTimeout(async ()=>{ setCatDeleteStatus({ kind: null, text: '' }); setCatDelete(null); await loadDynCats(); }, 1500);\n                  } catch (err) {\n                    setCatDeleteStatus({ kind: 'error', text: err.message || 'An error occurred.' });\n                    setTimeout(()=>setCatDeleteStatus({ kind: null, text: '' }), 2000);\n                  }\n                }}\n                className=\"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700\"\n              >Delete</button>\n            </div>\n          )}\n        </div>\n      </Modal>\n\n      {/* Entry Delete */}\n      <Modal open={!!entryDelete} onClose={()=>setEntryDelete(null)} title=\"Delete Entry\">\n        <div className=\"space-y-4\">\n          <p className=\"text-sm text-gray-700\">Delete <span className=\"font-medium\">{entryDelete?.title || 'this entry'}</span>?</p>\n          {entryDeleteStatus.kind ? (\n            <div className={`px-4 py-2 rounded-md text-sm ${entryDeleteStatus.kind==='success' ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'}`}>{entryDeleteStatus.text}</div>\n          ) : (\n            <div className=\"flex justify-end gap-2\">\n              <button type=\"button\" onClick={()=>setEntryDelete(null)} className=\"px-4 py-2 rounded-md border\">Cancel</button>\n              <button\n                type=\"button\"\n                onClick={async ()=>{\n                  try {\n                    if (!entryDelete) return;\n                    const r = await fetch(`${API_BASE}/tourism/entries/${entryDelete.id}`, { method: 'DELETE', headers: { Authorization: `Bearer ${token}` }});\n                    if (!r.ok) { const e = await r.json().catch(()=>({})); throw new Error(e.error || 'Failed to delete'); }\n                    const cid = entryDelete.category_id;\n                    setEntryDeleteStatus({ kind: 'success', text: 'Deleted successfully.' });\n                    setTimeout(async ()=>{ setEntryDeleteStatus({ kind: null, text: '' }); setEntryDelete(null); if (cid) await loadEntries(cid); }, 1500);\n                  } catch (err) {\n                    setEntryDeleteStatus({ kind: 'error', text: err.message || 'An error occurred.' });\n                    setTimeout(()=>setEntryDeleteStatus({ kind: null, text: '' }), 2000);\n                  }\n                }}\n                className=\"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700\"\n              >Delete</button>\n            </div>\n          )}\n        </div>\n      </Modal>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}